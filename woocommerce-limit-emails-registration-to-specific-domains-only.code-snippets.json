{"generator":"Code Snippets v2.14.0","date_created":"2020-03-25 21:50","snippets":[{"name":"WooCommerce: Limit emails registration to specific domains only","tags":["woocommerce","registration","emails","domain"],"scope":"global","code":"add_action('woocommerce_register_post','is_valid_registration_email_domain', 10, 3 );\nfunction is_valid_registration_email_domain( $username, $email, $validation_errors ){\n    $valid_email_domains = array( 'gmail.com', 'yahoo.com' ); \/\/ Allowed domains\n    $valid = false; \/\/ sets default validation to false\n    foreach( $valid_email_domains as $d ){\n        $d_length = strlen( $d );\n        $current_email_domain = strtolower( substr( $email, -($d_length), $d_length));\n        if( $current_email_domain == strtolower($d) ){\n            $valid = true;\n            break;\n        }\n    }\n\n    \/\/ Return error message for invalid domains\n    if( ! $valid ){\n        $error_text = __( \"<strong>ERROR<\/strong>: Registration is only allowed from selected approved domains. If you think you are seeing this in error, please contact the system administrator.\", \"woocommerce\" );\n        $validation_errors->add( 'domain_whitelist_error', $error_text );\n    }\n}\n@lukecav\n","priority":"10"}]}