{"generator":"Code Snippets v2.14.0","date_created":"2020-03-24 13:25","snippets":[{"name":"WooCommerce: Display discount\/offer percentage","tags":["woocommerce","discount","percentage"],"scope":"front-end","code":"add_filter('woocommerce_sale_flash', 'wc_savings_on_sales_flash');\n\nfunction wc_savings_on_sales_flash() {\n\tglobal $post, $product;\n   $sale_flash = '';\n\t\n\tif ($product->is_on_sale() && $product->product_type == 'variable') {\n\t\t$available_variations = $product->get_available_variations();\t\t\t\t\t\t\t\t\n\t\t$maximumper = 0;\n\t\t\n\t  \tfor ($i = 0; $i < count($available_variations); ++$i) {\n\t\t\t$variation_id=$available_variations[$i]['variation_id'];\n\t\t\t$variable_product1= new WC_Product_Variation( $variation_id );\n\t\t\t$regular_price = $variable_product1 ->regular_price;\n\t\t\t$sales_price = $variable_product1 ->sale_price;\n\t\t\t$percentage= round((( ( $regular_price - $sales_price ) \/ $regular_price ) * 100),1) ;\n\t\t\t\n\t\t  \tif ($percentage > $maximumper) {\n\t\t\t\t$maximumper = $percentage;\n\t\t\t}\n\t\t}\n\t  \n\t\t$savings = $price . sprintf( __('%s', 'woocommerce' ), $maximumper . '%' );\n\t} else if ($product->is_on_sale() && $product->product_type == 'simple') {\n\t\t$percentage = round( ( ( $product->regular_price - $product->sale_price ) \/ $product->regular_price ) * 100 );\n\t\t$savings = $price . sprintf( __('%s', 'woocommerce' ), $percentage . '%' );\n\t}\n  \n  \tif ($product->is_on_sale()) {\n  \t\t$sale_flash = '<span class=\"onsale\">' . $savings . ' OFF<\/span>';\n\t}\n  \n  \treturn $sale_flash;\n}","priority":"10"}]}